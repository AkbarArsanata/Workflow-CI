| Kategori                    | Deskripsi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| --------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Dataset**                 | Dataset yang digunakan adalah [Bank Turnover Dataset](https://www.kaggle.com/datasets/barelydedicated/bank-customer-churn-modeling), yang berisi 10.000 baris data nasabah bank dari wilayah geografis yang berbeda (Prancis, Jerman, dan Spanyol). Setiap baris mencakup informasi demografis (jenis kelamin, usia, status pernikahan), informasi keuangan (saldo, pendapatan tahunan, kredit skor), dan perilaku nasabah (jumlah produk, status keanggotaan aktif, dan apakah mereka keluar dari bank atau tidak). Target klasifikasi adalah variabel `Exited`.                                                           |
| **Masalah**                 | Permasalahan utama dalam proyek ini adalah melakukan prediksi apakah seorang nasabah akan meninggalkan (churn) bank atau tetap menjadi pelanggan. Hal ini merupakan permasalahan klasifikasi biner (binary classification), yang secara bisnis penting untuk mempertahankan loyalitas pelanggan. Prediksi churn secara akurat dapat membantu bank untuk menerapkan strategi retensi pelanggan yang lebih efektif dan efisien. Tantangannya meliputi ketidakseimbangan data (data imbalance), korelasi antar fitur, serta pemilihan fitur yang relevan.                                                                      |
| **Solusi Machine Learning** | Solusi yang diusulkan adalah membangun pipeline Machine Learning berbasis TFX (TensorFlow Extended) yang mencakup proses _data ingestion_, _data transformation_, _model training_, _hyperparameter tuning_, _model evaluation_, hingga _model serving_ secara otomatis. Model yang digunakan bertujuan untuk mempelajari pola perilaku churn pelanggan dan memprediksi nasabah yang berisiko churn. Untuk meningkatkan akurasi dan stabilitas model, dilakukan _hyperparameter tuning_ menggunakan KerasTuner.                                                                                                             |
| **Metode Pengolahan**       | Data diproses menggunakan **TensorFlow Transform (TFT)** dalam pipeline TFX, dengan langkah-langkah sebagai berikut:<br>• **Fitur numerik** seperti `CreditScore`, `Age`, `Tenure`, `Balance`, `NumOfProducts`, `HasCrCard`, `IsActiveMember`, dan `EstimatedSalary` dinormalisasi menggunakan **z-score scaling** untuk menyamakan skala antar fitur.<br>• **Fitur kategorikal** `Geography` dan `Gender` dikonversi menjadi **indeks integer** yang stabil menggunakan teknik **vocabulary encoding** (`tft.compute_and_apply_vocabulary`).<br>• **Label target** `Exited` diubah ke tipe data `int64` untuk memastikan kompatibilitas dengan fungsi loss klasifikasi.<br>• Semua hasil transformasi diberi akhiran **`_xf`** agar terpisah dari data mentah dan mudah dilacak sepanjang pipeline.<br>• Proses ini juga mengasumsikan telah dilakukan **validasi awal** untuk memastikan tidak ada nilai `null` dan semua kolom memiliki format yang sesuai sebelum masuk ke tahap transformasi dan training. |
| **Arsitektur Model**        | **1. Input Layer**<br>Model ini menerima dua jenis input: (a) **Fitur numerik** (`float32`, shape `(1,)` per fitur), terdiri dari `Age`, `Balance`, `CreditScore`, `EstimatedSalary`, `NumOfProducts`, `Tenure`, `HasCrCard`, dan `IsActiveMember`. Semua fitur ini diasumsikan telah melalui proses transformasi seperti normalisasi z-score. (b) **Fitur kategorikal** (`int64`, shape `(1,)` per fitur), yaitu `Gender` dan `Geography`, yang telah dikonversi menjadi indeks integer melalui proses vocabulary encoding. Setiap fitur dimasukkan sebagai input tensor individual (`tf.keras.Input`), sehingga total terdapat 10 input.<br><br>**2. Embedding Layer (untuk fitur kategorikal)**<br>Fitur `Gender` memiliki 2 kategori + 1 OOV (`input_dim=3`, `output_dim=4`), dan `Geography` memiliki 3 kategori + 1 OOV (`input_dim=4`, `output_dim=4`). Output dari masing-masing embedding diratakan (`Reshape`) menjadi vektor `(4,)` untuk digabungkan dengan fitur numerik. Embedding ini memungkinkan representasi laten yang lebih kompak dan informatif dibandingkan one-hot encoding.<br><br>**3. Feature Concatenation**<br>Semua fitur numerik dan hasil embedding digabung menggunakan `layers.Concatenate()`, membentuk representasi gabungan dari seluruh fitur pelanggan.<br><br>**4. Hidden Layers**<br>Model memiliki beberapa hidden layer: `Dense(64, activation='relu')`, `Dense(32, activation='relu')`, `Dropout(0.3)`, dan `Dense(16, activation='relu')`. Arsitektur ini dirancang untuk menangkap interaksi fitur secara nonlinier, sambil mengurangi risiko overfitting dengan regularisasi dropout.<br><br>**5. Output Layer**<br>Lapisan output terdiri dari `Dense(1, activation='sigmoid')` yang menghasilkan nilai probabilitas churn antara 0 hingga 1.<br><br>**6. Loss Function & Optimizer**<br>Model menggunakan fungsi loss `binary_crossentropy` dan optimizer `Adam` dengan `learning_rate=0.001`.<br><br>**7. Compile & Evaluation Metrics**<br>Model dikompilasi dengan metrik evaluasi `accuracy` (`BinaryAccuracy`), `AUC`, `precision`, dan `recall`, untuk mengevaluasi performa klasifikasi secara lebih komprehensif.<br><br>**8. Signature Serving**<br>Model disiapkan untuk deployment menggunakan `serve_tf_examples_fn`, yang menerima input bertipe `tf.Example` (serialized), melakukan parsing serta transformasi balik menggunakan `tf_transform_output`, dan mengembalikan hasil prediksi. Signature ini digunakan dalam `SavedModel` yang diekspor untuk keperluan serving di lingkungan produksi.
|
| **Metrik Evaluasi**         | Evaluasi model dilakukan menggunakan beberapa metrik klasifikasi biner:<br>• **AUC (Area Under ROC Curve):** Metrik utama untuk melihat performa model dalam membedakan kelas churn dan non-churn. <br>• **Accuracy:** Mengukur proporsi prediksi benar dari total prediksi. <br>• **Precision & Recall:** Digunakan untuk memahami keseimbangan antara false positives dan false negatives. <br>• **Confusion Matrix:** Untuk visualisasi klasifikasi dan kesalahan model.                                                                                                                                                 |
| **Performa Model**          | Setelah dilakukan hyperparameter tuning dan pelatihan model, diperoleh hasil sebagai berikut: <br>• **AUC tertinggi pada data validasi** mencapai 0.86, menunjukkan model cukup baik dalam membedakan nasabah yang churn dan yang tidak. <br>• **Accuracy** berada di kisaran 80-82%, tergantung pada kombinasi parameter. <br>• Hyperparameter terbaik diperoleh dari tuner dengan kombinasi 3 hidden layer (64-32-16 units), learning rate 0.001, dan dropout 0.3. <br>• Model akhir dievaluasi dan diberkati (blessed) oleh komponen Evaluator, dan siap untuk didorong ke tahap deployment menggunakan komponen Pusher. |
